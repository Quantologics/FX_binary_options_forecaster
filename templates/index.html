<!doctype html>
<html lang="en">

  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <title> FX Binary Options Forecaster </title>
     <link href="{{url_for('static', filename='dataTables.min.css')}}" rel="stylesheet" > 
    <link href="{{url_for('static', filename='bootstrap.min.css')}}" rel="stylesheet" > 
    <link href="{{url_for('static', filename='style.css')}}" rel="stylesheet" > 
    <link href="{{url_for('static', filename='bootstrap-select.css')}}" rel="stylesheet" > 
   


   </head> 
       <body>     
            
            
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="#">FX Binary Options Forecaster</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item active">
        <a class="nav-link" href="http://localhost:8050/"> Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/Quantologics" target="_blank"> Quantologics </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://www.freeforexapi.com" target="_blank"> Data Provider - Free Forex API </a>
      </li>
    </ul>
  </div>
</nav>            
      
       
<div>
    <p>  </p>
</div>      

<div>
    <p>  </p>
</div>  

<div>
    <p>  </p>
</div>  

<div class="col-12" style="text-align: center;">
    &nbsp;
</div>


<form method="POST" action="/">
    <div class="row">
        <div class="col-5" style="text-align: center;">
            &nbsp;
        </div>
        <div class="col-1" style="text-align: center;">
           <select name="myselect" id="myselect" onchange="this.form.submit()">
                <option value="eur">EUR/USD</option>
                <option value="gbp">GBP/USD</option>
                <option value="chf">CHF/USD</option>
                <option value="jpy">USD/JPY</option>
            </select>
        </div>
        <div class="col-1" style="text-align: center;">
            <select name="myselect2" id="myselect2" onchange="this.form.submit()">
                <option value="1">1 min</option>
                <option value="2">2 min</option>
                <option value="3">3 min</option>
                <option value="4">5 min</option>
            </select> 
        </div>
        <div class="col-5" style="text-align: center;">
            &nbsp;
        </div>
    </div>
    <div class="col-12" style="text-align: center;">
        &nbsp;
    </div>
    <div class="col-12" style="text-align: center;">
        <button type="submit" name="submit" value="submit"> Run model </button>
    </div>
</form>


<form method="POST" action="/result">

</form>

<div>
    <p>  </p>
</div> 


<div>
    <p>  </p>
</div>  

<div class="row"> 
    <div id = "main" class="col" > 
            <h4 style="text-align: center; font-size: 30px;">
            <span style="color: rgb(0, 0, 0);"> {{res}}</span></h4>
    </div>
</div> 

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<span style="color: rgb(255, 255, 255);"> {{res|safe}},</span>
<span style="color: rgb(31, 119, 180);"> {{res|safe}} </span>
<script src="{{url_for('static', filename='js/jquery.min.js')}}"></script> 
<script src="{{url_for('static', filename='js/alasql.js')}}"></script> 
<!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script> -->
 <script src="{{url_for('static', filename='js/popper.min.js')}}"></script> 
<!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script> -->
<script src="{{url_for('static', filename='js/bootstrap.min.js')}}"></script>
<script src="{{url_for('static', filename='js/dataTables.min.js')}}"></script>
<script src="{{url_for('static', filename='js/bootstrap-select.js')}}"></script>
<script src="http://cdn.sockjs.org/sockjs-0.3.min.js"></script>
<script src="stomp.js"></script>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>


<!-- HTML -->
<div class="row"> 
        <div class="col-1" style="text-align: center;">
            &nbsp;
        </div>
        <div class="col-10" style="text-align: center;">
            <div id="chartdiv"></div>
        </div>
        <div class="col-1" style="text-align: center;">
            &nbsp;
        </div>
</div>

<div class="row"> 
    <div class="col-1" style="text-align: center;">
        &nbsp;
    </div>
    <div class="col-10" style="text-align: left;">
    <a href="https://www.freeforexapi.com">
        <img alt="Free Forex API" src="https://www.freeforexapi.com/Images/link.png" height="20">
    </a>
    </div>
    <div class="col-1" style="text-align: center;">
        &nbsp;
    </div>
</div>
<!-- <div id="app"></div> -->

<!-- Styles -->
<style>
#chartdiv {
  width: 100%;
  height: 500px;
}
</style>

<!-- Resources -->
<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>


<script>
fetch("https://www.freeforexapi.com/api/live?pairs=EURGBP,USDJPY")
  .then((response) => {
    return response.json()
  })
  .then((data) => {
        const h1 = document.createElement('h1');
        h1.textContent = data;
        console.log(data)
        div.appendChild(h1); 
  })
  .catch((err) => {
    // Do something for an error here
  })
</script>

<script>
const div = document.querySelector("#app");
<!-- const url = "https://jsonplaceholder.typicode.com/posts/1"; -->
const_url  = "https://www.freeforexapi.com/api/live?pairs=EURGBP,USDJPY"

// sending request
fetch(url).then((response)=>{  return response.json();  // converting byte data to json
}).then(data=>{
    console.log(data)
   // creating h1 and p elements
   const h1 = document.createElement('h1');

  // adding content
  h1.textContent = data;
  

  // appending to div element
  div.appendChild(h1);  
                        })
</script>




<script src="{{url_for('static', filename='js/jquery.min.js')}}"></script> 
<script src="{{url_for('static', filename='js/popper.min.js')}}"></script> 
<script src="{{url_for('static', filename='js/bootstrap.min.js')}}"></script>
<script src="{{ url_for('static', filename='js/echarts.min.js') }}"></script>
<script src="../static/js/echarts.js" charset="utf-8"></script>


<script>
am4core.ready(function() {

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

var chart = am4core.create("chartdiv", am4charts.XYChart);
chart.hiddenState.properties.opacity = 0;

chart.padding(0, 0, 0, 0);

chart.zoomOutButton.disabled = true;

var data = [];
var visits = 10;
var i = 0;

for (i = 0; i <= 30; i++) {
    visits -= Math.round((Math.random() < 0.5 ? 1 : -1) * Math.random() * 10);
    data.push({ date: new Date().setSeconds(i - 30), value: visits });
}

chart.data = data;

var dateAxis = chart.xAxes.push(new am4charts.DateAxis());
dateAxis.renderer.grid.template.location = 0;
dateAxis.renderer.minGridDistance = 30;
dateAxis.dateFormats.setKey("second", "ss");
dateAxis.periodChangeDateFormats.setKey("second", "[bold]h:mm a");
dateAxis.periodChangeDateFormats.setKey("minute", "[bold]h:mm a");
dateAxis.periodChangeDateFormats.setKey("hour", "[bold]h:mm a");
dateAxis.renderer.inside = true;
dateAxis.renderer.axisFills.template.disabled = true;
dateAxis.renderer.ticks.template.disabled = true;

var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
valueAxis.tooltip.disabled = true;
valueAxis.interpolationDuration = 500;
valueAxis.rangeChangeDuration = 500;
valueAxis.renderer.inside = true;
valueAxis.renderer.minLabelPosition = 0.05;
valueAxis.renderer.maxLabelPosition = 0.95;
valueAxis.renderer.axisFills.template.disabled = true;
valueAxis.renderer.ticks.template.disabled = true;

var series = chart.series.push(new am4charts.LineSeries());
series.dataFields.dateX = "date";
series.dataFields.valueY = "value";
series.interpolationDuration = 500;
series.defaultState.transitionDuration = 0;
series.tensionX = 0.8;

chart.events.on("datavalidated", function () {
    dateAxis.zoom({ start: 1 / 15, end: 1.2 }, false, true);
});

dateAxis.interpolationDuration = 500;
dateAxis.rangeChangeDuration = 500;

document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
        if (interval) {
            clearInterval(interval);
        }
    }
    else {
        startInterval();
    }
}, false);

// add data
var interval;
function startInterval() {
    interval = setInterval(function() {
        visits =
            visits + Math.round((Math.random() < 0.5 ? 1 : -1) * Math.random() * 5);
        var lastdataItem = series.dataItems.getIndex(series.dataItems.length - 1);
        chart.addData(
            { date: new Date(lastdataItem.dateX.getTime() + 1000), value: visits },
            1
        );
    }, 1000);
}

startInterval();

// all the below is optional, makes some fancy effects
// gradient fill of the series
series.fillOpacity = 1;
var gradient = new am4core.LinearGradient();
gradient.addColor(chart.colors.getIndex(0), 0.2);
gradient.addColor(chart.colors.getIndex(0), 0);
series.fill = gradient;

// this makes date axis labels to fade out
dateAxis.renderer.labels.template.adapter.add("fillOpacity", function (fillOpacity, target) {
    var dataItem = target.dataItem;
    return dataItem.position;
})

// need to set this, otherwise fillOpacity is not changed and not set
dateAxis.events.on("validated", function () {
    am4core.iter.each(dateAxis.renderer.labels.iterator(), function (label) {
        label.fillOpacity = label.fillOpacity;
    })
})

// this makes date axis labels which are at equal minutes to be rotated
dateAxis.renderer.labels.template.adapter.add("rotation", function (rotation, target) {
    var dataItem = target.dataItem;
    if (dataItem.date && dataItem.date.getTime() == am4core.time.round(new Date(dataItem.date.getTime()), "minute").getTime()) {
        target.verticalCenter = "middle";
        target.horizontalCenter = "left";
        return -90;
    }
    else {
        target.verticalCenter = "bottom";
        target.horizontalCenter = "middle";
        return 0;
    }
})

// bullet at the front of the line
var bullet = series.createChild(am4charts.CircleBullet);
bullet.circle.radius = 5;
bullet.fillOpacity = 1;
bullet.fill = chart.colors.getIndex(0);
bullet.isMeasured = false;

series.events.on("validated", function() {
    bullet.moveTo(series.dataItems.last.point);
    bullet.validatePosition();
});

}); // end am4core.ready()
</script>

<div id="main" style="width: 600px;height:400px;"></div>


</body>
</html>
